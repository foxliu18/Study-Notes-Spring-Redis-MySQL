## 数据库表的类型

数据引擎

**INNODB**

默认使用

支持事务

支持数据行锁

支持外键

原本不支持全文索引

表空间较大，约为MYISAM两倍

**MYISAM**

不支持事务

不支持数据行锁定，使用表锁

不支持外键

支持全文索引

表空间较小

> 常规使用操作

+ MYISAM 节约空间,速度较快
+ INNODB 安全性高,支持事务处理,多标多用户操作

> 在物理空间存在的位置

所有数据库文件都存在data目录下, 一个文件夹就对应一个数据库

本质还是文件的存储

MySQL引擎在物理文件上的区别

+ InnoDB在数据库表中只有一个*.frm文件,以及上级目录下的ibdata1文件
+ MYISAM对应文件
  + *.frm 表结构文件
  + *.MYD 数据文件(data)
  + *.MYI 索引文件(Index)

> 数据库表的字符集编码

不设置会是mysql默认的字符集编码

## MySQL数据管理

### 外键



### DML语言

#### 添加

#### 修改

#### 删除

## 事务

什么是事务

要么都成功, 要么都失败

将一组SQL放在一个批次中去执行

> 事务原则

**原子性（Atomicity）**：操作这些指令时，要么全部执行成功，要么全部不执行。

**一致性（Consistency）**：事务的执行使数据从一个状态转换为另一个状态，但是对于整个数据的完整性保持稳定。

**持久性（Durability）**：当事务正确完成后，它对于数据的改变是永久性的。

**隔离性（Isolation）**：隔离性是当多个用户并发访问数据库时，比如操作同一张表时，数据库为每一个用户开启的事务，不能被其他事务的操作所干扰，多个并发事务之间要相互隔离。

## 并发事务导致的问题

**脏读**：脏读是指在一个事务处理过程里读取了另一个未提交的事务中的数据。

**幻读也叫虚读**：一个事务执行两次查询，第二次结果集包含第一次中没有或某些行已经被删除的数据，造成两次结果不一致，只是另一个事务在这两次查询中间插入或删除了数据造成的。幻读是事务非独立执行时发生的一种现象。(数据多了一条)

**不可重复读**：一个事务两次读取同一行的数据，结果得到不同状态的结果，中间正好另一个事务更新了该数据，两次结果相异，不可被信任。(多次读内容不一致)

> Tips：不可重复读和脏读的区别：脏读是某一事务读取了另一个事务未提交的脏数据，而不可重复读则是读取了前一事务提交的数据。
>
> Tips：幻读和不可重复读都是读取了另一条已经提交的事务（这点就脏读不同），所不同的是不可重复读查询的都是同一个数据项，而幻读针对的是一批数据整体（比如数据的个数）。
>
> Mysql的默认隔离级别是Repeatable read。

## 索引

MySQL官方对索引的定义为：索引（Index）是帮助MySQL高效获取数据的数据结构

MyISAM引擎使用B+Tree作为索引结构，叶节点的data域存放的是数据记录的地址。

InnoDB也使用B+Tree作为索引结构，但具体实现方式却与MyISAM截然不同。

索引分类

+ 主键索引(primary key)

  ​	主键不可重复只能有一列作为主键

+ 唯一索引(unique key)

  ​	避免重复的列值出现,唯一索引可以重复,多个列都可以标识唯一索引

+ 常规索引(key/index)

  ​	默认的索引,用key index来设置

+ 全文索引(fulltext)

  ​	这特定引擎下才有,MyISAM,新的innoDB也有

  ​	快速定位数据

  ​	

索引原则

+ 索引不是越多越好
+ 不要对经常变动的数据叫索引
+ 小数据量的表不需要加索引
+ 索引一般加在常用于查寻的字段上

## 规范数据库设计

**三大范式**

1. 第一范式

   原子性:要求数据库表的每一列都是不可再分的原子数据项

2. 满足第一范式前提下,非主键属性必须完全依赖与主键

   每张表只描述一件事情

   

3. 满足一二范式前提下,数据表每一列护具都要和主键直接相关

规范数据库设计,规范性和性能不可兼得

一般关联查寻的表不得超过三张表

+ 考虑商业化和目标,数据库性能更加重要
+ 在规范性能的问题时候,要适当考虑规范性
+ 故意给某些表增加冗余字段,从多表查寻变为单表查寻
+ 故意增加一些计算列(增加索引)